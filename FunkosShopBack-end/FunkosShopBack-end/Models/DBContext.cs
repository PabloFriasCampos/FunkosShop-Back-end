using FunkosShopBack_end.Models.Entities;
using Microsoft.EntityFrameworkCore;
using Microsoft.IdentityModel.Tokens;
using FunkosShopBack_end.Resources;

using System.Data;


namespace FunkosShopBack_end.Models
{
    public class DBContext : DbContext
    {
        private const string DATABASE_PATH = "funkos.db";

        public DbSet<Carrito> Carritos { get; set; }
        public DbSet<ProductoCarrito> ListaProductosCarrito { get; set; }
        public DbSet<ProductoPedido> ListaProductosPedido { get; set; }
        public DbSet<Pedido> Pedidos { get; set; }
        public DbSet<Producto> Productos { get; set; }
        public DbSet<Usuario> Usuarios { get; set; }

        protected override void OnConfiguring(DbContextOptionsBuilder options)
        {
            string baseDir = AppDomain.CurrentDomain.BaseDirectory;
            options.UseSqlite($"DataSource={baseDir}{DATABASE_PATH}");
        }

        public bool RegistrarUsuario(Usuario usuario)
        {
            bool guardado = false;
            Carrito carrito = new Carrito();
            carrito.Usuario = usuario;
            if (Usuarios.FirstOrDefault(usuarioin => usuarioin.Correo == usuario.Correo
            || usuarioin.NombreUsuario == usuario.NombreUsuario) == null)
            {
                Usuarios.Add(usuario);
                Carritos.Add(carrito);
                SaveChanges();
                guardado = true;
            }

            return guardado;
        }

        public void RegistrarProducto(Producto producto)
        {
            Productos.Add(producto);
            SaveChanges();
        }

        public int AutenticarUsuario(string correo, string contrasena)
        {
            Usuario usuario = Usuarios.FirstOrDefault(usuario => usuario.Correo == correo && usuario.Contrasena == contrasena);

            if (usuario != null)
            {
                return usuario.UsuarioID;
            }

            return -1;
        }

        public void RegistraListaProductoCarrito(ProductoCarrito productoCarrito)
        {
            ListaProductosCarrito.Add(productoCarrito); 
            
            SaveChanges();
        }

        public void modificarCantidad(int productoID, int carritoID, int cantidad)
        {
            var listaProducto = ListaProductosCarrito.First(p => p.Producto.ProductoID == productoID && p.Carrito.CarritoID == carritoID);
            listaProducto.CantidadProducto += cantidad;

            if (listaProducto.CantidadProducto == 0)
            {
                ListaProductosCarrito.Remove(listaProducto);
            }
            else
            {
                listaProducto.TotalProductoEUR = (double)(listaProducto.CantidadProducto * listaProducto.Producto.PrecioEUR);
            }

            
            SaveChanges();
        }

        public bool productoYaEnCarrito(int productoID, int carritoID)
        {
            var listaExiste = ListaProductosCarrito.Where(p => p.Producto.ProductoID == productoID && p.Carrito.CarritoID == carritoID).ToList();
            enviaEmail(2);
            return listaExiste.IsNullOrEmpty();
        }

        public void enviaEmail(int idPedido)
        {
            Pedido pedido = Pedidos
                                .Include(p => p.ListaProductosPedido)
                                    .ThenInclude(l => l.Producto)
                                .First(p => p.PedidoID == idPedido);
            
            string productos = "";
            foreach (ProductoPedido prodComprado in pedido.ListaProductosPedido) 
            {
             //   productos += "<div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\r\n    <div class=\"u-row no-stack\" style=\"margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap:\r\n        break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n        <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\r\n            <div class=\"u-col u-col-33p33\" style=\"max-width: 225px;min-width: 200px;display:\r\n                table-cell;vertical-align: top;\">\r\n                <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\"> <!--[if (!mso)&(!IE)]><!-->\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                        transparent;border-left: 0px solid transparent;border-right: 0px solid\r\n                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;\r\n                        -moz-border-radius: 0px;\"> <!--<![endif]-->\r\n                        <table id=\"u_content_heading_10\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                            role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                            <tbody>\r\n                                <tr>\r\n                                    <img src=\"/1.png\">\r\n                                </tr>\r\n                            </tbody>\r\n                        </table>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class=\"u-col u-col-33p33\" style=\"max-width: 225px;min-width: 200px; display: <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\r\n                <div class=\"u-row no-stack\"\r\n                    style=\"margin: 0 auto;min-width: 320px;max-width: 600px;overflow-wrap:        break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n                    <div\r\n                        style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color: transparent;\">\r\n                        <div class=\"u-col u-col-33p33\"\r\n                            style=\"max-width: 320px;min-width: 200px;display:                table-cell;vertical-align: top;\">\r\n                            <div\r\n                                style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                                <div\r\n                                    style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid                        transparent;border-left: 0px solid transparent;border-right: 0px solid                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;                        -moz-border-radius: 0px;\">\r\n                                    <table id=\"u_content_heading_10\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                                        <tbody>\r\n                                            <tr> <img src=\"1.png\"> </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"u-col u-col-33p33\"\r\n                            style=\"max-width: 320px;min-width: 200px;display:                table-cell;vertical-align: top;\">\r\n                            <div\r\n                                style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                                <!--[if (!mso)&(!IE)]><!-->\r\n                                <div\r\n                                    style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid                        transparent;border-left: 0px solid transparent;border-right: 0px solid                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;                        -moz-border-radius: 0px;\">\r\n                                    <!--<![endif]-->\r\n                                    <table id=\"u_content_heading_10\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                                        <tbody>\r\n                                            <tr>\r\n                                                <td class=\"v-container-padding-padding\"\r\n                                                    style=\"overflow-wrap:break-word;word-break:break-word;padding:10px 10px                                        11px;font-family:arial,helvetica,sans-serif;\"\r\n                                                    align=\"left\">\r\n                                                    <h1 class=\"v-text-align v-font-size\"\r\n                                                        style=\"margin: 0px; line-height: 140%;                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'                                            ,sans-serif; font-size: 14px; font-weight: 400;\">" + prodComprado.Producto.NombreProducto + "</h1>\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"u-col u-col-33p33\"\r\n                            style=\"max-width: 320px;min-width: 200px;display:                table-cell;vertical-align: top;\">\r\n                            <div\r\n                                style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                                <div\r\n                                    style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid                        transparent;border-left: 0px solid transparent;border-right: 0px solid                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;                        -moz-border-radius: 0px;\">\r\n                                    <table id=\"u_content_heading_11\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                                        <tbody>\r\n                                            <tr>\r\n                                                <td class=\"v-container-padding-padding\"\r\n                                                    style=\"overflow-wrap:break-word;word-break:break-word;padding:20px                                        10px;font-family:arial,helvetica,sans-serif;\"\r\n                                                    align=\"left\">\r\n                                                    <h1 class=\"v-text-align v-font-size\"\r\n                                                        style=\"margin: 0px; line-height: 140%;                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'                                            ,sans-serif; font-size: 14px; font-weight: 400;\">\r\n                                                        <strong>1</strong>\r\n                                                    </h1>\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class=\"u-col u-col-33p33\"\r\n                            style=\"max-width: 320px;min-width: 200px;display:                table-cell;vertical-align: top;\">\r\n                            <div\r\n                                style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                                <div\r\n                                    style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid                        transparent;border-left: 0px solid transparent;border-right: 0px solid                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;                        -moz-border-radius: 0px;\">\r\n                                    <table id=\"u_content_heading_12\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                                        <tbody>\r\n                                            <tr>\r\n                                                <td class=\"v-container-padding-padding\"\r\n                                                    style=\"overflow-wrap:break-word;word-break:break-word;padding:20px                                        10px;font-family:arial,helvetica,sans-serif;\"\r\n                                                    align=\"left\"> <!--[if mso]><table width=\"100%\"><tr><td><![endif]-->\r\n                                                    <h1 class=\"v-text-align v-font-size\"\r\n                                                        style=\"margin: 0px; line-height: 140%;                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'                                            ,sans-serif; font-size: 14px; font-weight: 400;\">\r\n                                                        <strong>" + prodComprado.TotalProductoEUR + " €"+ "</strong>                                                    </h1> <!--[if mso]></td></tr></table><![endif]-->\r\n                                                </td>\r\n                                            </tr>\r\n                                        </tbody>\r\n                                    </table> <!--[if (!mso)&(!IE)]><!-->\r\n                                </div><!--<![endif]-->\r\n                            </div>\r\n                        </div> <!--[if (mso)|(IE)]></td><![endif]-->\r\n                        <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            table-cell;vertical-align: top;\">\r\n            <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\"> <!--[if (!mso)&(!IE)]><!-->\r\n                <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                        transparent;border-left: 0px solid transparent;border-right: 0px solid\r\n                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;\r\n                        -moz-border-radius: 0px;\"> <!--<![endif]-->\r\n                    <table id=\"u_content_heading_10\" style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\"\r\n                        cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:10px 10px\r\n                                        11px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                                    <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; line-height: 140%;\r\n                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'\r\n                                            ,sans-serif; font-size: 14px; font-weight: 400;\">"+                                       prodComprado.Producto.NombreProducto + "</h1>                                </td>                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"u-col u-col-33p33\" style=\"max-width: 225px;min-width: 200px;display:\r\n                table-cell;vertical-align: top;\">\r\n            <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                        transparent;border-left: 0px solid transparent;border-right: 0px solid\r\n                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;\r\n                        -moz-border-radius: 0px;\">\r\n                    <table id=\"u_content_heading_11\" style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\"\r\n                        cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:20px\r\n                                        10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                                    <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; line-height: 140%;\r\n                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'\r\n                                            ,sans-serif; font-size: 14px; font-weight: 400;\"> <strong>1</strong> </h1>\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class=\"u-col u-col-33p33\" style=\"max-width: 225px;min-width: 200px;display:\r\n                table-cell;vertical-align: top;\">\r\n            <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                        transparent;border-left: 0px solid transparent;border-right: 0px solid\r\n                        transparent;border-bottom: 0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px;\r\n                        -moz-border-radius: 0px;\">\r\n                    <table id=\"u_content_heading_12\" style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\"\r\n                        cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                            <tr>\r\n                                <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:20px\r\n                                        10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                                    <!--[if mso]><table width=\"100%\"><tr><td><![endif]-->\r\n                                    <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; line-height: 140%;\r\n                                            text-align: center; word-wrap: break-word; font-family: 'Montserrat'\r\n                                            ,sans-serif; font-size: 14px; font-weight: 400;\"> <strong>" +                                          prodComprado.TotalProductoEUR + "</strong> </h1>                                  <!--[if mso]></td></tr></table><![endif]-->\r\n                                </td>\r\n                            </tr>\r\n                        </tbody>\r\n                    </table> <!--[if (!mso)&(!IE)]><!-->\r\n                </div><!--<![endif]-->\r\n            </div>\r\n        </div> <!--[if (mso)|(IE)]></td><![endif]--> <!--[if (mso)|(IE)]></tr></table></td></tr></table><![endif]-->\r\n    </div>\r\n</div>\r\n</div>";


            }
            //string solofecha = pedido.FechaPedido.Year.ToString()+"-"+ pedido.FechaPedido.Month.ToString()+"-"+ pedido.FechaPedido.Day.ToString();

            //string html = "<html xmlns=\"http://www.w3.org/1999/xhtml\" xmlns:v=\"urn:schemas-microsoft-com:vml\"\r\n  xmlns:o=\"urn:schemas-microsoft-com:office:office\">\r\n<header>\r\n  <link href=\"https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap\" rel=\"stylesheet\" type=\"text/css\">\r\n  <link href=\"https://fonts.googleapis.com/css?family=Montserrat:400,700&display=swap\" rel=\"stylesheet\" type=\"text/css\">\r\n  <style type=\"text/css\">\r\n    @media only screen and (min-width: 620px) {\r\n      .u-row {\r\n        width: 600px !important;\r\n      }\r\n\r\n      .u-row .u-col {\r\n        vertical-align: top;\r\n      }\r\n\r\n      .u-row .u-col-31p67 {\r\n        width: 190.02px !important;\r\n      }\r\n\r\n      .u-row .u-col-33p33 {\r\n        width: 199.98px !important;\r\n      }\r\n\r\n      .u-row .u-col-35 {\r\n        width: 210px !important;\r\n      }\r\n\r\n      .u-row .u-col-50 {\r\n        width: 300px !important;\r\n      }\r\n\r\n      .u-row .u-col-66p67 {\r\n        width: 400.02px !important;\r\n      }\r\n\r\n      .u-row .u-col-100 {\r\n        width: 600px !important;\r\n      }\r\n    }\r\n\r\n    @media (max-width: 620px) {\r\n      .u-row-container {\r\n        max-width: 100% !important;\r\n        padding-left: 0px !important;\r\n        padding-right: 0px !important;\r\n      }\r\n\r\n      .u-row .u-col {\r\n        min-width: 320px !important;\r\n        max-width: 100% !important;\r\n        display: block !important;\r\n      }\r\n\r\n      .u-row {\r\n        width: 100% !important;\r\n      }\r\n\r\n      .u-col {\r\n        width: 100% !important;\r\n      }\r\n\r\n      .u-col>div {\r\n        margin: 0 auto;\r\n      }\r\n\r\n      .no-stack .u-col {\r\n        min-width: 0 !important;\r\n        display: table-cell !important;\r\n      }\r\n\r\n      .no-stack .u-col-31p67 {\r\n        width: 31.67% !important;\r\n      }\r\n\r\n      .no-stack .u-col-33p33 {\r\n        width: 33.33% !important;\r\n      }\r\n\r\n      .no-stack .u-col-35 {\r\n        width: 35% !important;\r\n      }\r\n\r\n      .no-stack .u-col-50 {\r\n        width: 50% !important;\r\n      }\r\n\r\n      .no-stack .u-col-66p67 {\r\n        width: 66.67% !important;\r\n      }\r\n    }\r\n\r\n    body {\r\n      margin: 0;\r\n      padding: 0;\r\n    }\r\n\r\n    table,\r\n    tr,\r\n    td {\r\n      vertical-align: top;\r\n      border-collapse: collapse;\r\n    }\r\n\r\n    p {\r\n      margin: 0;\r\n    }\r\n\r\n    .ie-container table,\r\n    .mso-container table {\r\n      table-layout: fixed;\r\n    }\r\n\r\n    * {\r\n      line-height: inherit;\r\n    }\r\n\r\n    a[x-apple-data-detectors='true'] {\r\n      color: inherit !important;\r\n      text-decoration: none !important;\r\n    }\r\n\r\n    table,\r\n    td {\r\n      color: #000000;\r\n    }\r\n\r\n    #u_body a {\r\n      color: #0000ee;\r\n      text-decoration: underline;\r\n    }\r\n\r\n    @media (max-width: 480px) {\r\n      #u_content_image_4 .v-container-padding-padding {\r\n        padding: 20px 5px 5px !important;\r\n      }\r\n\r\n      #u_content_image_4 .v-src-width {\r\n        width: auto !important;\r\n      }\r\n\r\n      #u_content_image_4 .v-src-max-width {\r\n        max-width: 49% !important;\r\n      }\r\n\r\n      #u_content_image_5 .v-container-padding-padding {\r\n        padding: 20px 5px 5px !important;\r\n      }\r\n\r\n      #u_content_image_5 .v-src-width {\r\n        width: auto !important;\r\n      }\r\n\r\n      #u_content_image_5 .v-src-max-width {\r\n        max-width: 30% !important;\r\n      }\r\n\r\n      #u_content_heading_3 .v-container-padding-padding {\r\n        padding: 10px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_image_6 .v-container-padding-padding {\r\n        padding: 21px 5px 5px !important;\r\n      }\r\n\r\n      #u_content_image_6 .v-src-width {\r\n        width: auto !important;\r\n      }\r\n\r\n      #u_content_image_6 .v-src-max-width {\r\n        max-width: 46% !important;\r\n      }\r\n\r\n      #u_content_heading_4 .v-container-padding-padding {\r\n        padding: 14px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_5 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_heading_5 .v-font-size {\r\n        font-size: 14px !important;\r\n      }\r\n\r\n      #u_content_heading_6 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_heading_6 .v-font-size {\r\n        font-size: 14px !important;\r\n      }\r\n\r\n      #u_content_heading_7 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_heading_7 .v-font-size {\r\n        font-size: 14px !important;\r\n      }\r\n\r\n      #u_content_heading_10 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_heading_11 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_12 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_22 .v-container-padding-padding {\r\n        padding: 11px 10px 10px !important;\r\n      }\r\n\r\n      #u_content_heading_23 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_24 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_19 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_heading_20 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_21 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_17 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_18 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_14 .v-container-padding-padding {\r\n        padding: 40px 10px !important;\r\n      }\r\n\r\n      #u_content_heading_30 .v-container-padding-padding {\r\n        padding: 40px 10px 39px !important;\r\n      }\r\n\r\n      #u_content_heading_31 .v-container-padding-padding {\r\n        padding: 33px 10px 31px 22px !important;\r\n      }\r\n\r\n      #u_content_heading_15 .v-container-padding-padding {\r\n        padding: 20px 10px !important;\r\n      }\r\n\r\n      #u_content_text_27 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_image_7 .v-container-padding-padding {\r\n        padding: 24px 18px 23px 5px !important;\r\n      }\r\n\r\n      #u_content_text_28 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_image_8 .v-container-padding-padding {\r\n        padding: 24px 18px 22px 5px !important;\r\n      }\r\n\r\n      #u_content_text_29 .v-container-padding-padding {\r\n        padding: 10px !important;\r\n      }\r\n\r\n      #u_content_image_9 .v-container-padding-padding {\r\n        padding: 24px 18px 23px 5px !important;\r\n      }\r\n\r\n      #u_content_image_11 .v-src-width {\r\n        width: auto !important;\r\n      }\r\n\r\n      #u_content_image_11 .v-src-max-width {\r\n        max-width: 100% !important;\r\n      }\r\n\r\n      #u_content_text_30 .v-text-align {\r\n        text-align: center !important;\r\n      }\r\n    }\r\n  </style>\r\n</header>\r\n\r\n<body class=\"clean-body u_body\" style=\"margin: 0;padding: 0;-webkit-text-size-adjust: 100%;background-color:\r\n  #e7e7e7;color: #000000\" max-width=\"900px\">\r\n  <table id=\"u_body\" style=\"border-collapse: collapse;table-layout: fixed;border-spacing: 0;\r\n  vertical-align: top;min-width: 320px;Margin: 0 auto;background-color: #e7e7e7;width:100%\" cellpadding=\"0\"\r\n    cellspacing=\"0\">\r\n    <tbody>\r\n      <tr style=\"vertical-align: top\">\r\n        <td style=\"word-break: break-word;border-collapse: collapse !important;vertical-align: top\">\r\n          <!--Header imagen logo-->\r\n          <div class=\"u-row-container\" style=\"padding: 0px;background-image:\r\n            url('https://i.imgur.com/B89z31R.jpeg');background-repeat: no-repeat;background-position: center\r\n            top;background-color: transparent\">\r\n            <div class=\"u-row\" style=\"margin: 0 auto;min-width: 320px;max-width: 900px;overflow-wrap:\r\n              break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color:\r\n                transparent;\">\r\n                <div class=\"u-col u-col-100\" style=\"max-width: 320px;min-width: 600px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"height: 100%;width: 100% !important;border-radius: 0px;-webkit-border-radius: 0px;\r\n                    -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\" cellpadding=\"0\"\r\n                        cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:30px 10px 251px\r\n                              30px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; text-shadow: 0\r\n                                0 30px #000000; line-height: 130%; text-align: left; word-wrap: break-word;\r\n                                font-family: 'Montserrat' ,sans-serif; font-size: 40px; font-weight: 400;\">\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n          <!--Header pedido ID-->\r\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\r\n            <div class=\"u-row no-stack\" style=\"margin: 0 auto;min-width: 320px;max-width: 900px;overflow-wrap:\r\n              break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color:\r\n                transparent;\">\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 199.98px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\" cellpadding=\"0\"\r\n                        cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:12px 10px\r\n                              38px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                              <!--AQUI VA EL ID DEL PEDIDO-->\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; line-height: 140%; text-align:\r\n                                center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif; font-size: 14px;\r\n                                font-weight: 400;\"> Pedido Nr: <strong> + idPedido + </strong></h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\" u-col u-col-35\" style=\"max-width: 320px;min-width: 210px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_3\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:10px 10px\r\n                              38px;font-family:arial,helvetica,sans-serif;\" align=\"left\"> <!--FECHA DEL PEDIDO-->\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; line-height: 140%; text-align:\r\n                                center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif; font-size: 14px;\r\n                                font-weight: 400;\"> Fecha del Pedido: <strong> + solofecha + </strong> </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"u-col u-col-31p67\" style=\"max-width: 320px;min-width: 190.02px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_image_6\" style=\"font-family:arial,helvetica,sans-serif;\" role=\"presentation\"\r\n                        cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\"> </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n\r\n          <!--HEADER TITULOS PRODUCTO CANTIDAD PRECIO-->\r\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\r\n            <div class=\"u-row no-stack\" style=\"margin: 0 auto;min-width: 320px;max-width: 900px;overflow-wrap:\r\n              break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color:\r\n                transparent;\">\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 200px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #1b1c4a;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_5\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\"\r\n                              style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:arial,helvetica,sans-serif;\"\r\n                              align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; line-height:\r\n                                140%; text-align: center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 18px; font-weight: 400;\"> <strong>Producto</strong> </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 200px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #1b1c4a;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_6\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\"\r\n                              style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:arial,helvetica,sans-serif;\"\r\n                              align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; line-height:\r\n                                140%; text-align: center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 18px; font-weight: 400;\"> <strong>Cantidad</strong> </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 200px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #1b1c4a;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_7\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\"\r\n                              style=\"overflow-wrap:break-word;word-break:break-word;padding:10px;font-family:arial,helvetica,sans-serif;\"\r\n                              align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; line-height:\r\n                                140%; text-align: center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 18px; font-weight: 400;\"> <strong>Total</strong> </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div> + productos +\r\n          <!--header TOTAL PEDIDO -->\r\n          <div class=\"u-row-container\" style=\"padding: 0px;background-color: transparent\">\r\n            <div class=\"u-row no-stack\" style=\"margin: 0 auto;min-width: 320px;max-width: 900px;overflow-wrap:\r\n              break-word;word-wrap: break-word;word-break: break-word;background-color: transparent;\">\r\n              <div style=\"border-collapse: collapse;display: table;width: 100%;height: 100%;background-color:\r\n                transparent;\">\r\n                <div class=\"u-col u-col-66p67\" style=\"max-width: 320px;min-width: 400px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #ffffff;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_31\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:20px 10px 20px\r\n                              270px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #1b1c4a; line-height:\r\n                                140%; text-align: left; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 20px; font-weight: 400;\"> <strong>TOTAL</strong> </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 200px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #1b1c4a;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_15\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:20px\r\n                              10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; line-height:\r\n                                140%; text-align: center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 18px; font-weight: 400;\"> <strong> + pedido.TotalPedidoEUR + </strong>\r\n                              </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n                <div class=\"u-col u-col-33p33\" style=\"max-width: 320px;min-width: 200px;display:\r\n                  table-cell;vertical-align: top;\">\r\n                  <div style=\"background-color: #1b1c4a;height: 100%;width: 100% !important;border-radius:\r\n                    0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                    <div style=\"box-sizing: border-box; height: 100%; padding: 0px;border-top: 0px solid\r\n                      transparent;border-left: 0px solid transparent;border-right: 0px solid transparent;border-bottom:\r\n                      0px solid transparent;border-radius: 0px;-webkit-border-radius: 0px; -moz-border-radius: 0px;\">\r\n                      <table id=\"u_content_heading_15\" style=\"font-family:arial,helvetica,sans-serif;\"\r\n                        role=\"presentation\" cellpadding=\"0\" cellspacing=\"0\" width=\"100%\" border=\"0\">\r\n                        <tbody>\r\n                          <tr>\r\n                            <td class=\"v-container-padding-padding\" style=\"overflow-wrap:break-word;word-break:break-word;padding:20px\r\n                              10px;font-family:arial,helvetica,sans-serif;\" align=\"left\">\r\n                              <h1 class=\"v-text-align v-font-size\" style=\"margin: 0px; color: #ffffff; line-height:\r\n                                140%; text-align: center; word-wrap: break-word; font-family: 'Montserrat' ,sans-serif;\r\n                                font-size: 18px; font-weight: 400;\"> <strong> + pedido.TotalPedidoETH + </strong>\r\n                              </h1>\r\n                            </td>\r\n                          </tr>\r\n                        </tbody>\r\n                      </table>\r\n                    </div>\r\n                  </div>\r\n                </div>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </td>\r\n      </tr>\r\n    </tbody>\r\n  </table>\r\n</body>\r\n\r\n</html>";
            
            //EmailService.SendMessageAsync("ionutpop@hotmail.es", "Test1", html, true);
           
        }
    }
}

    

